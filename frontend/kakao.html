<!DOCTYPE html>
<html>
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KIVOSY ì¹´í†¡ ì†¡ì‹ ê¸°</title>
    <style>
        body { font-family: sans-serif; padding: 20px; background: #1a1a1e; color: white; }
        textarea { width: 100%; height: 150px; background: #2d2d32; color: white; border: 1px solid #444; border-radius: 10px; padding: 10px; box-sizing: border-box; }
        button { width: 100%; padding: 15px; margin-top: 10px; background: #ff9500; border: none; border-radius: 10px; color: white; font-weight: bold; cursor: pointer; }
    </style>
</head>
<body>
    <h2>ğŸš€ 14B ê³¼ì¥ë‹˜ê»˜ ë³´ê³ </h2>
    <textarea id="msg" placeholder="ì¹´í†¡ ë‚´ìš©ì„ ì—¬ê¸° ë¶™ì—¬ë„£ìœ¼ì„¸ìš”..."></textarea>
    <button onclick="send()">ì „ì†¡í•˜ê¸°</button>

    <script>
        async function send() {
            const btn = document.querySelector('button');
            const msgField = document.getElementById('msg');
            const content = msgField.value;

            if(!content) return alert("ë‚´ìš©ì„ ì…ë ¥í•˜ì„¸ìš”!");

            // 1. ë²„íŠ¼ ìƒíƒœ ë³€ê²½ (ê¸°ê°• ì¡ê¸°)
            btn.disabled = true;
            btn.innerText = "â³ ì•¼ê°„ ê³¼ì¥ ë¶„ì„ ì¤‘...";
            btn.style.background = "#555";

            try {
                const res = await fetch('/api/kakao', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ sender: 'ê³µì¥ì¥(Mobile)', content: content })
                });

                if(res.ok) {
                    alert('âœ… ê³¼ì¥ë‹˜ì´ ë³´ê³ ë¥¼ ì ‘ìˆ˜í–ˆìŠµë‹ˆë‹¤!');
                    msgField.value = ''; // ì…ë ¥ì°½ ë¹„ìš°ê¸°
                }
            } catch(e) {
                alert('âŒ ì„œë²„ ì—°ê²° ì‹¤íŒ¨!');
            } finally {
                // 2. ë²„íŠ¼ ë³µêµ¬
                btn.disabled = false;
                btn.innerText = "ì „ì†¡í•˜ê¸°";
                btn.style.background = "#ff9500";
            }
        }
    </script>
</body>
</html>